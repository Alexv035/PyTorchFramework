{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"LmBGZ3qnl2zT","executionInfo":{"status":"ok","timestamp":1643296818385,"user_tz":-180,"elapsed":7286,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["import torch\n","import numpy as np\n"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"zDyoQzy7l2zZ","executionInfo":{"status":"ok","timestamp":1643296818386,"user_tz":-180,"elapsed":8,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Создайте случайный FloatTensor размера 3x4x5"]},{"cell_type":"code","source":["def print_tens_info(tensor):\n","    print(\"X :\\n%s\\n\" % tensor)\n","    print(\"X количество измерений:\\n%s\\n\" % tensor.dim())\n","    print(\"X размеры : \",  tensor.size())\n","    print(\"X тип : %s\\n\" % (tensor.type()))"],"metadata":{"id":"yO03ASCOl6Ad","executionInfo":{"status":"ok","timestamp":1643296818386,"user_tz":-180,"elapsed":7,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["x = torch.arange(0,60).view(3,4,5).type(torch.float32)"],"metadata":{"id":"o-3ZmuJZm_d8","executionInfo":{"status":"ok","timestamp":1643296824317,"user_tz":-180,"elapsed":353,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["print_tens_info(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"c1jsU7c7nC2B","outputId":"7ce795c2-3fd1-4f60-e51a-2e67d8e6c890","executionInfo":{"status":"ok","timestamp":1643296825256,"user_tz":-180,"elapsed":5,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["X :\n","tensor([[[ 0.,  1.,  2.,  3.,  4.],\n","         [ 5.,  6.,  7.,  8.,  9.],\n","         [10., 11., 12., 13., 14.],\n","         [15., 16., 17., 18., 19.]],\n","\n","        [[20., 21., 22., 23., 24.],\n","         [25., 26., 27., 28., 29.],\n","         [30., 31., 32., 33., 34.],\n","         [35., 36., 37., 38., 39.]],\n","\n","        [[40., 41., 42., 43., 44.],\n","         [45., 46., 47., 48., 49.],\n","         [50., 51., 52., 53., 54.],\n","         [55., 56., 57., 58., 59.]]])\n","\n","X количество измерений:\n","3\n","\n","X размеры :  torch.Size([3, 4, 5])\n","X тип : torch.FloatTensor\n","\n"]}]},{"cell_type":"code","execution_count":6,"metadata":{"id":"CqM8ee-xl2za","executionInfo":{"status":"ok","timestamp":1643296827946,"user_tz":-180,"elapsed":9,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Выведите его форму (shape)"]},{"cell_type":"code","source":["x.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UaUqeNOroSzZ","outputId":"146b0d7b-cdb9-4d61-aff6-93d399c07267","executionInfo":{"status":"ok","timestamp":1643296828826,"user_tz":-180,"elapsed":5,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":7,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([3, 4, 5])"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","execution_count":8,"metadata":{"id":"aLVYZwRKl2zb","executionInfo":{"status":"ok","timestamp":1643296829591,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Приведите его к форме 6 X 10"]},{"cell_type":"code","source":["xx = x.view(6,10)\n","xx"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zi920SUborDB","outputId":"990943a9-5303-4797-d077-069c1e9a6d77","executionInfo":{"status":"ok","timestamp":1643296830210,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.],\n","        [10., 11., 12., 13., 14., 15., 16., 17., 18., 19.],\n","        [20., 21., 22., 23., 24., 25., 26., 27., 28., 29.],\n","        [30., 31., 32., 33., 34., 35., 36., 37., 38., 39.],\n","        [40., 41., 42., 43., 44., 45., 46., 47., 48., 49.],\n","        [50., 51., 52., 53., 54., 55., 56., 57., 58., 59.]])"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","execution_count":10,"metadata":{"id":"TXQtj0kol2zb","executionInfo":{"status":"ok","timestamp":1643296833661,"user_tz":-180,"elapsed":304,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Умножьте его на вектор [1, 4, 2, 2, 1] поэлементно"]},{"cell_type":"code","source":["a = torch.FloatTensor([1, 4, 2, 2, 1])\n","x * a"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DYtqXQ2yX5H_","outputId":"158205f0-672f-4385-9288-50762dfc9caf","executionInfo":{"status":"ok","timestamp":1643296834560,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[[  0.,   4.,   4.,   6.,   4.],\n","         [  5.,  24.,  14.,  16.,   9.],\n","         [ 10.,  44.,  24.,  26.,  14.],\n","         [ 15.,  64.,  34.,  36.,  19.]],\n","\n","        [[ 20.,  84.,  44.,  46.,  24.],\n","         [ 25., 104.,  54.,  56.,  29.],\n","         [ 30., 124.,  64.,  66.,  34.],\n","         [ 35., 144.,  74.,  76.,  39.]],\n","\n","        [[ 40., 164.,  84.,  86.,  44.],\n","         [ 45., 184.,  94.,  96.,  49.],\n","         [ 50., 204., 104., 106.,  54.],\n","         [ 55., 224., 114., 116.,  59.]]])"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["a = torch.FloatTensor([1, 4, 2, 2, 1])\n","\n","print(torch.mv(x[0],a))\n","print(torch.mv(x[1],a))\n","print(torch.mv(x[2],a))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"asimHIE6o6L2","outputId":"126fce9e-9dc5-4d69-d5c8-7600b4174409","executionInfo":{"status":"ok","timestamp":1643296837390,"user_tz":-180,"elapsed":6,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([ 18.,  68., 118., 168.])\n","tensor([218., 268., 318., 368.])\n","tensor([418., 468., 518., 568.])\n"]}]},{"cell_type":"code","execution_count":13,"metadata":{"id":"jlBBoWgsl2zc","executionInfo":{"status":"ok","timestamp":1643296838503,"user_tz":-180,"elapsed":4,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["#Умножьте тензор матрично на себя, чтобы результат был размерности 6x6"]},{"cell_type":"code","source":["print(torch.mm(xx,xx.T))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YPsoEfUT-tqm","outputId":"951ce451-dbae-4526-e792-811925f102ab","executionInfo":{"status":"ok","timestamp":1643296839320,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[  285.,   735.,  1185.,  1635.,  2085.,  2535.],\n","        [  735.,  2185.,  3635.,  5085.,  6535.,  7985.],\n","        [ 1185.,  3635.,  6085.,  8535., 10985., 13435.],\n","        [ 1635.,  5085.,  8535., 11985., 15435., 18885.],\n","        [ 2085.,  6535., 10985., 15435., 19885., 24335.],\n","        [ 2535.,  7985., 13435., 18885., 24335., 29785.]])\n"]}]},{"cell_type":"code","execution_count":15,"metadata":{"id":"VRvF5-zel2zd","executionInfo":{"status":"ok","timestamp":1643296841084,"user_tz":-180,"elapsed":338,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Посчитайте производную функции y = x**3 + z - 75t в точке (1, 0.5, 2)"]},{"cell_type":"code","source":["from torch.autograd import Variable"],"metadata":{"id":"iE9scwX5BHtj","executionInfo":{"status":"ok","timestamp":1643296841915,"user_tz":-180,"elapsed":1,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["v = Variable(torch.from_numpy(np.array([1, 0.5, 2], dtype=\"float32\")))\n","x = Variable(v, requires_grad = True)\n","print_tens_info(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ov4AnZfc-_2t","outputId":"fac3a386-306f-4a5b-dc20-577a3a47567c","executionInfo":{"status":"ok","timestamp":1643296842246,"user_tz":-180,"elapsed":6,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["X :\n","tensor([1.0000, 0.5000, 2.0000], requires_grad=True)\n","\n","X количество измерений:\n","1\n","\n","X размеры :  torch.Size([3])\n","X тип : torch.FloatTensor\n","\n"]}]},{"cell_type":"code","source":["print(x.grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LBPVsfnRDfaz","outputId":"122fbaf8-e6c1-4912-96b9-5bc4a063fe80","executionInfo":{"status":"ok","timestamp":1643296844219,"user_tz":-180,"elapsed":262,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["None\n"]}]},{"cell_type":"code","source":["y = x**3 + x- 75*x"],"metadata":{"id":"A6y5fhPwDo_D","executionInfo":{"status":"ok","timestamp":1643296845235,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["y.backward(x)"],"metadata":{"id":"_WJkCCAyFRcW","executionInfo":{"status":"ok","timestamp":1643296849088,"user_tz":-180,"elapsed":325,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["print(x.grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GQZy57fIHAYu","outputId":"57c815a1-7098-4e63-aed9-afd04747c072","executionInfo":{"status":"ok","timestamp":1643296850647,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([ -71.0000,  -36.6250, -124.0000])\n"]}]},{"cell_type":"code","execution_count":22,"metadata":{"id":"-WobJ1Xll2ze","executionInfo":{"status":"ok","timestamp":1643296853339,"user_tz":-180,"elapsed":261,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Создайте единичный тензор размера 5x6"]},{"cell_type":"code","source":["# torch.ones(5,6)\n","x = Variable(torch.ones(5,6), requires_grad=True)\n","print_tens_info(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qcbEl29AHtCU","outputId":"9793b22d-f852-4930-e4bb-8e202ae7766c","executionInfo":{"status":"ok","timestamp":1643296854072,"user_tz":-180,"elapsed":9,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["X :\n","tensor([[1., 1., 1., 1., 1., 1.],\n","        [1., 1., 1., 1., 1., 1.],\n","        [1., 1., 1., 1., 1., 1.],\n","        [1., 1., 1., 1., 1., 1.],\n","        [1., 1., 1., 1., 1., 1.]], requires_grad=True)\n","\n","X количество измерений:\n","2\n","\n","X размеры :  torch.Size([5, 6])\n","X тип : torch.FloatTensor\n","\n"]}]},{"cell_type":"code","execution_count":24,"metadata":{"id":"i7w227XNl2zf","executionInfo":{"status":"ok","timestamp":1643296856168,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Переведите его в формат numpy"]},{"cell_type":"code","source":["# xa = x.numpy()\n","xa = x.detach().numpy()\n","print(type(xa))\n","print(xa)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2NeTSfOmICui","outputId":"24a76689-9c76-412b-f8d4-c86871b6061c","executionInfo":{"status":"ok","timestamp":1643296857375,"user_tz":-180,"elapsed":6,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'numpy.ndarray'>\n","[[1. 1. 1. 1. 1. 1.]\n"," [1. 1. 1. 1. 1. 1.]\n"," [1. 1. 1. 1. 1. 1.]\n"," [1. 1. 1. 1. 1. 1.]\n"," [1. 1. 1. 1. 1. 1.]]\n"]}]},{"cell_type":"code","execution_count":26,"metadata":{"id":"OsFKQe0ll2zg","executionInfo":{"status":"ok","timestamp":1643296859793,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"outputs":[],"source":["# Давайте теперь пооптимизируем: возьмите функцию y = x**w1 - 2 * x**2 + 5\n","# Посчитайте "]},{"cell_type":"code","source":["from torch import nn \n","from torch import optim"],"metadata":{"id":"W-fATtCrOLjd","executionInfo":{"status":"ok","timestamp":1643296860774,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":27,"outputs":[]},{"cell_type":"code","source":["linear = nn.Linear(6,5, bias=True)\n"],"metadata":{"id":"sX2KbikuOMM2","executionInfo":{"status":"ok","timestamp":1643296863211,"user_tz":-180,"elapsed":278,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["print ('w: ', linear.weight)\n","print ('b: ', linear.bias)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MFTEHjHPOYfV","outputId":"7b1fd4f8-af9b-42ce-b373-cf8c5a1680ed","executionInfo":{"status":"ok","timestamp":1643296865641,"user_tz":-180,"elapsed":321,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":29,"outputs":[{"output_type":"stream","name":"stdout","text":["w:  Parameter containing:\n","tensor([[-0.1001,  0.2867,  0.3258, -0.0566, -0.0213,  0.1744],\n","        [ 0.2373,  0.3533, -0.3531, -0.0965, -0.1970, -0.1214],\n","        [-0.3199, -0.2145,  0.1044, -0.2406, -0.2480, -0.3196],\n","        [ 0.3893,  0.2531,  0.1526,  0.1526,  0.3088, -0.0043],\n","        [ 0.3768, -0.3810,  0.0398,  0.4073, -0.2919,  0.0265]],\n","       requires_grad=True)\n","b:  Parameter containing:\n","tensor([ 0.3545, -0.0908,  0.1327,  0.3453, -0.0823], requires_grad=True)\n"]}]},{"cell_type":"code","source":["w1 = linear.weight\n","w1"],"metadata":{"id":"7zAczwH7OY8z","colab":{"base_uri":"https://localhost:8080/"},"outputId":"d8224cad-af8f-4350-80ec-e27c54942003","executionInfo":{"status":"ok","timestamp":1643296870349,"user_tz":-180,"elapsed":678,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":30,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Parameter containing:\n","tensor([[-0.1001,  0.2867,  0.3258, -0.0566, -0.0213,  0.1744],\n","        [ 0.2373,  0.3533, -0.3531, -0.0965, -0.1970, -0.1214],\n","        [-0.3199, -0.2145,  0.1044, -0.2406, -0.2480, -0.3196],\n","        [ 0.3893,  0.2531,  0.1526,  0.1526,  0.3088, -0.0043],\n","        [ 0.3768, -0.3810,  0.0398,  0.4073, -0.2919,  0.0265]],\n","       requires_grad=True)"]},"metadata":{},"execution_count":30}]},{"cell_type":"code","source":["y = x**w1 - 2 * x**2 + 5"],"metadata":{"id":"PeZk_8VDOfD8","executionInfo":{"status":"ok","timestamp":1643296872831,"user_tz":-180,"elapsed":4,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["import math\n","from torch.nn.parameter import Parameter\n"," \n","class My_Linear(nn.Module):\n","     \n","    def __init__(self, in_F, out_F):\n","        super(My_Linear, self).__init__()\n","        self.weight = Parameter(torch.Tensor(out_F, in_F))\n","        self.bias   = Parameter(torch.Tensor(out_F))\n","             \n","        self.reset_parameters()\n"," \n","    def reset_parameters(self):\n","        for p in self.parameters():\n","            stdv =  1.0 / math.sqrt(p.shape[0])\n","            p.data.uniform_(-stdv, stdv)   \n"," \n","    def forward(self, x):\n","        return  x ** self.weight.t() - 2 * x**2 + 5 + self.bias"],"metadata":{"id":"aOxrS1JJGPzw","executionInfo":{"status":"ok","timestamp":1643296907770,"user_tz":-180,"elapsed":4,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":32,"outputs":[]},{"cell_type":"code","source":["linear = My_Linear(6, 5)"],"metadata":{"id":"Zyew_GUgGkQl","executionInfo":{"status":"ok","timestamp":1643296916525,"user_tz":-180,"elapsed":255,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":33,"outputs":[]},{"cell_type":"code","source":["print ('w: ', linear.weight)\n","print ('b: ', linear.bias)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"K3QkkPxTGl3-","outputId":"7a943df7-42fc-4d99-a423-55fcd0e9cd64","executionInfo":{"status":"ok","timestamp":1643296917583,"user_tz":-180,"elapsed":11,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":34,"outputs":[{"output_type":"stream","name":"stdout","text":["w:  Parameter containing:\n","tensor([[ 0.0507, -0.1957, -0.4036, -0.4046, -0.2628,  0.4370],\n","        [ 0.2074, -0.1223,  0.3486, -0.4267, -0.0608, -0.0858],\n","        [ 0.1873, -0.3470, -0.1848,  0.1843, -0.1311, -0.0946],\n","        [-0.1500, -0.1397,  0.3266, -0.1717,  0.1352, -0.2308],\n","        [ 0.0984,  0.3178,  0.3349, -0.3211, -0.1635,  0.4321]],\n","       requires_grad=True)\n","b:  Parameter containing:\n","tensor([ 0.2116, -0.2212,  0.3242, -0.0826,  0.3658], requires_grad=True)\n"]}]},{"cell_type":"code","source":["criterion = nn.MSELoss()"],"metadata":{"id":"3xzBO2vuGue7","executionInfo":{"status":"ok","timestamp":1643296920862,"user_tz":-180,"elapsed":5,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["optimizer = torch.optim.SGD(linear.parameters(), lr=0.01)"],"metadata":{"id":"4aYMcMDCG_4U","executionInfo":{"status":"ok","timestamp":1643296923240,"user_tz":-180,"elapsed":280,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","source":["x = Variable(torch.randn(5), requires_grad = True)\n","y = Variable(torch.randn(5), requires_grad = False)"],"metadata":{"id":"TPFP5sZiGxVV","executionInfo":{"status":"ok","timestamp":1643296923942,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["optimizer.zero_grad()\n","pred = linear(x)\n","loss = criterion(pred, y)\n","print('loss: ', loss.item())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wivOxaDgGzjC","outputId":"0dd318fe-3dac-412f-e3a7-bd47fc39ab7d","executionInfo":{"status":"ok","timestamp":1643296925604,"user_tz":-180,"elapsed":4,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":38,"outputs":[{"output_type":"stream","name":"stdout","text":["loss:  nan\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/torch/nn/modules/loss.py:520: UserWarning: Using a target size (torch.Size([5])) that is different to the input size (torch.Size([6, 5])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.\n","  return F.mse_loss(input, target, reduction=self.reduction)\n"]}]},{"cell_type":"code","source":["print ('dL/dw: ', linear.weight.grad) \n","print ('dL/db: ', linear.bias.grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"l2aRu1XTG1ie","outputId":"cfd4180f-a7f2-4526-d6af-ba12b1a693d1","executionInfo":{"status":"ok","timestamp":1643296927670,"user_tz":-180,"elapsed":325,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":39,"outputs":[{"output_type":"stream","name":"stdout","text":["dL/dw:  None\n","dL/db:  None\n"]}]},{"cell_type":"code","source":["loss.backward()"],"metadata":{"id":"TfnFCOP4HMX9","executionInfo":{"status":"ok","timestamp":1643296928532,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":40,"outputs":[]},{"cell_type":"code","source":["print ('dL/dw: ', linear.weight.grad) \n","print ('dL/db: ', linear.bias.grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FTcILA2CHONA","outputId":"47cb29e1-b883-4afb-cd02-a612c2546929","executionInfo":{"status":"ok","timestamp":1643296929855,"user_tz":-180,"elapsed":2,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":41,"outputs":[{"output_type":"stream","name":"stdout","text":["dL/dw:  tensor([[-0.4000, -0.5509, -0.7284, -0.7294, -0.6023, -0.2470],\n","        [    nan,     nan,     nan,     nan,     nan,     nan],\n","        [-0.3721, -0.7877, -0.6233, -0.3736, -0.5776, -0.5486],\n","        [    nan,     nan,     nan,     nan,     nan,     nan],\n","        [    nan,     nan,     nan,     nan,     nan,     nan]])\n","dL/db:  tensor([2.4170,    nan, 2.4683,    nan,    nan])\n"]}]},{"cell_type":"code","source":["print ('w: ', linear.weight)\n","print ('b: ', linear.bias)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vk6mHKBlHQCZ","outputId":"307fdee9-681c-4348-c77e-68d322f16cac","executionInfo":{"status":"ok","timestamp":1643296931209,"user_tz":-180,"elapsed":274,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":42,"outputs":[{"output_type":"stream","name":"stdout","text":["w:  Parameter containing:\n","tensor([[ 0.0507, -0.1957, -0.4036, -0.4046, -0.2628,  0.4370],\n","        [ 0.2074, -0.1223,  0.3486, -0.4267, -0.0608, -0.0858],\n","        [ 0.1873, -0.3470, -0.1848,  0.1843, -0.1311, -0.0946],\n","        [-0.1500, -0.1397,  0.3266, -0.1717,  0.1352, -0.2308],\n","        [ 0.0984,  0.3178,  0.3349, -0.3211, -0.1635,  0.4321]],\n","       requires_grad=True)\n","b:  Parameter containing:\n","tensor([ 0.2116, -0.2212,  0.3242, -0.0826,  0.3658], requires_grad=True)\n"]}]},{"cell_type":"code","source":["optimizer.step()"],"metadata":{"id":"ff6Cj5c3HS34","executionInfo":{"status":"ok","timestamp":1643296934081,"user_tz":-180,"elapsed":324,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":43,"outputs":[]},{"cell_type":"code","source":["print ('w: ', linear.weight)\n","print ('b: ', linear.bias)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YunZmL6iHVOi","outputId":"40b34370-930b-4609-c11a-084763ec4130","executionInfo":{"status":"ok","timestamp":1643296935042,"user_tz":-180,"elapsed":6,"user":{"displayName":"Alexander Voronkov","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11977783427516478269"}}},"execution_count":44,"outputs":[{"output_type":"stream","name":"stdout","text":["w:  Parameter containing:\n","tensor([[ 0.0547, -0.1902, -0.3963, -0.3973, -0.2567,  0.4395],\n","        [    nan,     nan,     nan,     nan,     nan,     nan],\n","        [ 0.1910, -0.3392, -0.1786,  0.1880, -0.1254, -0.0891],\n","        [    nan,     nan,     nan,     nan,     nan,     nan],\n","        [    nan,     nan,     nan,     nan,     nan,     nan]],\n","       requires_grad=True)\n","b:  Parameter containing:\n","tensor([0.1874,    nan, 0.2995,    nan,    nan], requires_grad=True)\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"74svcX28HXBo"},"execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.4"},"colab":{"name":"HW_01.ipynb\"","provenance":[{"file_id":"1fhPcS7d2VFVwaDaze9N6SIRA_iXG0AIg","timestamp":1643296781039}],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":0}